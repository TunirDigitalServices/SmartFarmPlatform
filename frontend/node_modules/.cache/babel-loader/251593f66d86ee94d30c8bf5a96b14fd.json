{"ast":null,"code":"import _regeneratorRuntime from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/var/www/prod/smartfarm/backoffice/frontend/src/views/MarkerMap.js\";\nimport React, { useState, useEffect, useRef, useMemo, useCallback } from \"react\";\nimport { Marker, Popup, useMap } from \"react-leaflet\";\nimport { Button } from 'shards-react';\nimport api from '../api/api';\nexport default function Markerwhatever(props) {\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      draggable = _useState2[0],\n      setDraggable = _useState2[1];\n\n  var _useState3 = useState({\n    lat: props.lat,\n    lng: props.long\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      position = _useState4[0],\n      setPosition = _useState4[1];\n\n  var markerRef = useRef(null);\n  var map = useMap();\n  var center = props.center;\n  if (typeof center !== \"undefined\" && center.length > 0 && props.fromAction === true) map.setView(center, props.zoom);\n  var eventHandlers = useMemo(function () {\n    return {\n      dragend: function dragend() {\n        var marker = markerRef.current;\n\n        if (marker != null) {\n          setPosition(marker.getLatLng());\n        }\n      },\n      click: function click(e) {\n        map.flyTo(e.latlng, 9);\n      }\n    };\n  }, []);\n  var toggleDraggable = useCallback(function () {\n    setDraggable(function (d) {\n      return !d;\n    });\n  }, []);\n\n  var savePosition = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var Latitude, Longitude, idFarm;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Latitude = position.lat;\n              Longitude = position.lng;\n              idFarm = props.id;\n              _context.next = 5;\n              return api.post('/farm/set-farm-position', {\n                idFarm: idFarm,\n                Latitude: Latitude,\n                Longitude: Longitude\n              }).then(function (res) {\n                console.log(res);\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 5:\n              setDraggable(false);\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function savePosition() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Marker, {\n    eventHandlers: eventHandlers,\n    draggable: draggable,\n    position: position,\n    ref: markerRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Popup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }\n  }, draggable ? /*#__PURE__*/React.createElement(\"i\", {\n    onClick: savePosition,\n    class: \"fa fa-check mx-2\",\n    title: \"save position\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }\n  }) : /*#__PURE__*/React.createElement(\"i\", {\n    onClick: toggleDraggable,\n    className: \"material-icons\",\n    title: \"edit position\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 11\n    }\n  }, \"\\uE3C9\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, props.name))));\n}","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","useCallback","Marker","Popup","useMap","Button","api","Markerwhatever","props","draggable","setDraggable","lat","lng","long","position","setPosition","markerRef","map","center","length","fromAction","setView","zoom","eventHandlers","dragend","marker","current","getLatLng","click","e","flyTo","latlng","toggleDraggable","d","savePosition","Latitude","Longitude","idFarm","id","post","then","res","console","log","catch","error","name"],"sources":["/var/www/prod/smartfarm/backoffice/frontend/src/views/MarkerMap.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo, useCallback } from \"react\";\nimport { Marker, Popup, useMap } from \"react-leaflet\";\nimport { Button } from 'shards-react'\nimport api from '../api/api';\nexport default function Markerwhatever(props) {\n  const [draggable, setDraggable] = useState(false)\n  const [position, setPosition] = useState({lat:props.lat, lng:props.long})\n  const markerRef = useRef(null)\n\n\n  const map = useMap();\n  let center = props.center\n  if(typeof center !== \"undefined\" && center.length > 0 && props.fromAction === true)\n    map.setView(center, props.zoom);\n      \n  \n  const eventHandlers = useMemo(\n    () => ({\n      dragend() {\n        const marker = markerRef.current\n        if (marker != null) {\n          setPosition(marker.getLatLng())\n        }\n      },\n      click: (e) => {\n        map.flyTo(e.latlng, 9);\n      }\n    }),\n    [],\n  )\n  const toggleDraggable = useCallback(() => {\n    setDraggable((d) => !d)\n  }, [])\n\n  const savePosition = async() => {\n    let Latitude = position.lat\n    let Longitude = position.lng\n    let idFarm = props.id\n    await api.post('/farm/set-farm-position', { idFarm, Latitude ,Longitude })\n      .then(res => {\n        console.log(res)\n      }).catch((error)=>{\n        console.log(error)\n      })\n    setDraggable(false)\n  }\n  return (\n    <div>\n      <Marker\n        eventHandlers={eventHandlers}\n        draggable={draggable}\n        position={position}\n        ref={markerRef}\n      >\n      <Popup>\n      {draggable ?\n        <i onClick={savePosition} class=\"fa fa-check mx-2\" title='save position'></i>\n        : <i  onClick={toggleDraggable} className=\"material-icons\" title='edit position'>&#xe3c9;</i> \n        }\n        \n        <div>\n        {props.name}\n        </div>\n      </Popup>\n      \n      </Marker>\n    </div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}