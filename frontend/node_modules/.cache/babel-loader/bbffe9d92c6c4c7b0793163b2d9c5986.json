{"ast":null,"code":"import { Html5QrcodeConstants, Html5QrcodeScanType, Html5QrcodeErrorFactory, BaseLoggger, isNullOrUndefined } from \"./core\";\nimport { Html5Qrcode } from \"./html5-qrcode\";\nimport { Html5QrcodeScannerStrings } from \"./strings\";\nimport { ASSET_FILE_SCAN, ASSET_CAMERA_SCAN } from \"./image-assets\";\nimport { PersistedDataManager } from \"./storage\";\nimport { LibraryInfoContainer } from \"./ui\";\nimport { CameraManager } from \"./camera\";\nimport { ScanTypeSelector } from \"./ui/scanner/scan-type-selector\";\nvar Html5QrcodeScannerStatus;\n\n(function (Html5QrcodeScannerStatus) {\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_DEFAULT\"] = 0] = \"STATUS_DEFAULT\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_SUCCESS\"] = 1] = \"STATUS_SUCCESS\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_WARNING\"] = 2] = \"STATUS_WARNING\";\n  Html5QrcodeScannerStatus[Html5QrcodeScannerStatus[\"STATUS_REQUESTING_PERMISSION\"] = 3] = \"STATUS_REQUESTING_PERMISSION\";\n})(Html5QrcodeScannerStatus || (Html5QrcodeScannerStatus = {}));\n\nfunction toHtml5QrcodeCameraScanConfig(config) {\n  return {\n    fps: config.fps,\n    qrbox: config.qrbox,\n    aspectRatio: config.aspectRatio,\n    disableFlip: config.disableFlip,\n    videoConstraints: config.videoConstraints\n  };\n}\n\nfunction toHtml5QrcodeFullConfig(config, verbose) {\n  return {\n    formatsToSupport: config.formatsToSupport,\n    experimentalFeatures: config.experimentalFeatures,\n    verbose: verbose\n  };\n}\n\nvar Html5QrcodeScanner = function () {\n  function Html5QrcodeScanner(elementId, config, verbose) {\n    this.lastMatchFound = null;\n    this.cameraScanImage = null;\n    this.fileScanImage = null;\n    this.elementId = elementId;\n    this.config = this.createConfig(config);\n    this.verbose = verbose === true;\n\n    if (!document.getElementById(elementId)) {\n      throw \"HTML Element with id=\" + elementId + \" not found\";\n    }\n\n    this.scanTypeSelector = new ScanTypeSelector(this.config.supportedScanTypes);\n    this.currentScanType = this.scanTypeSelector.getDefaultScanType();\n    this.sectionSwapAllowed = true;\n    this.logger = new BaseLoggger(this.verbose);\n    this.persistedDataManager = new PersistedDataManager();\n\n    if (config.rememberLastUsedCamera !== true) {\n      this.persistedDataManager.reset();\n    }\n  }\n\n  Html5QrcodeScanner.prototype.render = function (qrCodeSuccessCallback, qrCodeErrorCallback) {\n    var _this = this;\n\n    this.lastMatchFound = null;\n\n    this.qrCodeSuccessCallback = function (decodedText, result) {\n      if (qrCodeSuccessCallback) {\n        qrCodeSuccessCallback(decodedText, result);\n      } else {\n        if (_this.lastMatchFound === decodedText) {\n          return;\n        }\n\n        _this.lastMatchFound = decodedText;\n\n        _this.setHeaderMessage(Html5QrcodeScannerStrings.lastMatch(decodedText), Html5QrcodeScannerStatus.STATUS_SUCCESS);\n      }\n    };\n\n    this.qrCodeErrorCallback = function (errorMessage, error) {\n      if (qrCodeErrorCallback) {\n        qrCodeErrorCallback(errorMessage, error);\n      }\n    };\n\n    var container = document.getElementById(this.elementId);\n\n    if (!container) {\n      throw \"HTML Element with id=\" + this.elementId + \" not found\";\n    }\n\n    container.innerHTML = \"\";\n    this.createBasicLayout(container);\n    this.html5Qrcode = new Html5Qrcode(this.getScanRegionId(), toHtml5QrcodeFullConfig(this.config, this.verbose));\n  };\n\n  Html5QrcodeScanner.prototype.pause = function (shouldPauseVideo) {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n\n    if (isNullOrUndefined(shouldPauseVideo) || shouldPauseVideo !== true) {\n      shouldPauseVideo = false;\n    }\n\n    this.html5Qrcode.pause(shouldPauseVideo);\n  };\n\n  Html5QrcodeScanner.prototype.resume = function () {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n\n    this.html5Qrcode.resume();\n  };\n\n  Html5QrcodeScanner.prototype.getState = function () {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n\n    return this.html5Qrcode.getState();\n  };\n\n  Html5QrcodeScanner.prototype.clear = function () {\n    var _this = this;\n\n    var emptyHtmlContainer = function emptyHtmlContainer() {\n      var mainContainer = document.getElementById(_this.elementId);\n\n      if (mainContainer) {\n        mainContainer.innerHTML = \"\";\n\n        _this.resetBasicLayout(mainContainer);\n      }\n    };\n\n    if (this.html5Qrcode) {\n      return new Promise(function (resolve, reject) {\n        if (!_this.html5Qrcode) {\n          resolve();\n          return;\n        }\n\n        if (_this.html5Qrcode.isScanning) {\n          _this.html5Qrcode.stop().then(function (_) {\n            if (!_this.html5Qrcode) {\n              resolve();\n              return;\n            }\n\n            _this.html5Qrcode.clear();\n\n            emptyHtmlContainer();\n            resolve();\n          }).catch(function (error) {\n            if (_this.verbose) {\n              _this.logger.logError(\"Unable to stop qrcode scanner\", error);\n            }\n\n            reject(error);\n          });\n        } else {\n          _this.html5Qrcode.clear();\n\n          emptyHtmlContainer();\n        }\n      });\n    }\n\n    return Promise.resolve();\n  };\n\n  Html5QrcodeScanner.prototype.getRunningTrackCapabilities = function () {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n\n    return this.html5Qrcode.getRunningTrackCapabilities();\n  };\n\n  Html5QrcodeScanner.prototype.applyVideoConstraints = function (videoConstaints) {\n    if (!this.html5Qrcode) {\n      throw \"Code scanner not initialized.\";\n    }\n\n    return this.html5Qrcode.applyVideoConstraints(videoConstaints);\n  };\n\n  Html5QrcodeScanner.prototype.createConfig = function (config) {\n    if (config) {\n      if (!config.fps) {\n        config.fps = Html5QrcodeConstants.SCAN_DEFAULT_FPS;\n      }\n\n      if (config.rememberLastUsedCamera !== !Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED) {\n        config.rememberLastUsedCamera = Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED;\n      }\n\n      return config;\n    }\n\n    return {\n      fps: Html5QrcodeConstants.SCAN_DEFAULT_FPS,\n      rememberLastUsedCamera: Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED,\n      supportedScanTypes: Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE\n    };\n  };\n\n  Html5QrcodeScanner.prototype.createBasicLayout = function (parent) {\n    parent.style.position = \"relative\";\n    parent.style.padding = \"0px\";\n    parent.style.border = \"1px solid silver\";\n    this.createHeader(parent);\n    var qrCodeScanRegion = document.createElement(\"div\");\n    var scanRegionId = this.getScanRegionId();\n    qrCodeScanRegion.id = scanRegionId;\n    qrCodeScanRegion.style.width = \"100%\";\n    qrCodeScanRegion.style.minHeight = \"100px\";\n    qrCodeScanRegion.style.textAlign = \"center\";\n    parent.appendChild(qrCodeScanRegion);\n\n    if (ScanTypeSelector.isCameraScanType(this.currentScanType)) {\n      this.insertCameraScanImageToScanRegion();\n    } else {\n      this.insertFileScanImageToScanRegion();\n    }\n\n    var qrCodeDashboard = document.createElement(\"div\");\n    var dashboardId = this.getDashboardId();\n    qrCodeDashboard.id = dashboardId;\n    qrCodeDashboard.style.width = \"100%\";\n    parent.appendChild(qrCodeDashboard);\n    this.setupInitialDashboard(qrCodeDashboard);\n  };\n\n  Html5QrcodeScanner.prototype.resetBasicLayout = function (mainContainer) {\n    mainContainer.style.border = \"none\";\n  };\n\n  Html5QrcodeScanner.prototype.setupInitialDashboard = function (dashboard) {\n    var $this = this;\n    this.createSection(dashboard);\n    this.createSectionControlPanel();\n\n    if (this.scanTypeSelector.hasMoreThanOneScanType()) {\n      this.createSectionSwap();\n    }\n  };\n\n  Html5QrcodeScanner.prototype.createHeader = function (dashboard) {\n    var header = document.createElement(\"div\");\n    header.style.textAlign = \"left\";\n    header.style.margin = \"0px\";\n    dashboard.appendChild(header);\n    var libraryInfo = new LibraryInfoContainer();\n    libraryInfo.renderInto(header);\n    var headerMessageContainer = document.createElement(\"div\");\n    headerMessageContainer.id = this.getHeaderMessageContainerId();\n    headerMessageContainer.style.display = \"none\";\n    headerMessageContainer.style.textAlign = \"center\";\n    headerMessageContainer.style.fontSize = \"14px\";\n    headerMessageContainer.style.padding = \"2px 10px\";\n    headerMessageContainer.style.margin = \"4px\";\n    headerMessageContainer.style.borderTop = \"1px solid #f6f6f6\";\n    header.appendChild(headerMessageContainer);\n  };\n\n  Html5QrcodeScanner.prototype.createSection = function (dashboard) {\n    var section = document.createElement(\"div\");\n    section.id = this.getDashboardSectionId();\n    section.style.width = \"100%\";\n    section.style.padding = \"10px 0px 10px 0px\";\n    section.style.textAlign = \"left\";\n    dashboard.appendChild(section);\n  };\n\n  Html5QrcodeScanner.prototype.createCameraListUi = function (scpCameraScanRegion, requestPermissionContainer, requestPermissionButton) {\n    var $this = this;\n    $this.setHeaderMessage(Html5QrcodeScannerStrings.cameraPermissionRequesting());\n\n    var createPermissionButtonIfNotExists = function createPermissionButtonIfNotExists() {\n      if (!requestPermissionButton) {\n        $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n      }\n    };\n\n    Html5Qrcode.getCameras().then(function (cameras) {\n      $this.persistedDataManager.setHasPermission(true);\n      $this.resetHeaderMessage();\n\n      if (cameras && cameras.length > 0) {\n        scpCameraScanRegion.removeChild(requestPermissionContainer);\n        $this.renderCameraSelection(cameras);\n      } else {\n        $this.setHeaderMessage(Html5QrcodeScannerStrings.noCameraFound(), Html5QrcodeScannerStatus.STATUS_WARNING);\n        createPermissionButtonIfNotExists();\n      }\n    }).catch(function (error) {\n      $this.persistedDataManager.setHasPermission(false);\n\n      if (requestPermissionButton) {\n        requestPermissionButton.disabled = false;\n      } else {\n        createPermissionButtonIfNotExists();\n      }\n\n      $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n    });\n  };\n\n  Html5QrcodeScanner.prototype.createPermissionButton = function (scpCameraScanRegion, requestPermissionContainer) {\n    var $this = this;\n    var requestPermissionButton = document.createElement(\"button\");\n    requestPermissionButton.id = this.getCameraPermissionButtonId();\n    requestPermissionButton.innerText = Html5QrcodeScannerStrings.cameraPermissionTitle();\n    requestPermissionButton.addEventListener(\"click\", function () {\n      requestPermissionButton.disabled = true;\n      $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer, requestPermissionButton);\n    });\n    requestPermissionContainer.appendChild(requestPermissionButton);\n  };\n\n  Html5QrcodeScanner.prototype.createPermissionsUi = function (scpCameraScanRegion, requestPermissionContainer) {\n    var $this = this;\n\n    if (ScanTypeSelector.isCameraScanType(this.currentScanType) && this.persistedDataManager.hasCameraPermissions()) {\n      CameraManager.hasCameraPermissions().then(function (hasPermissions) {\n        if (hasPermissions) {\n          $this.createCameraListUi(scpCameraScanRegion, requestPermissionContainer);\n        } else {\n          $this.persistedDataManager.setHasPermission(false);\n          $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n        }\n      }).catch(function (_) {\n        $this.persistedDataManager.setHasPermission(false);\n        $this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n      });\n      return;\n    }\n\n    this.createPermissionButton(scpCameraScanRegion, requestPermissionContainer);\n  };\n\n  Html5QrcodeScanner.prototype.createSectionControlPanel = function () {\n    var $this = this;\n    var section = document.getElementById(this.getDashboardSectionId());\n    var sectionControlPanel = document.createElement(\"div\");\n    section.appendChild(sectionControlPanel);\n    var scpCameraScanRegion = document.createElement(\"div\");\n    scpCameraScanRegion.id = this.getDashboardSectionCameraScanRegionId();\n    scpCameraScanRegion.style.display = ScanTypeSelector.isCameraScanType(this.currentScanType) ? \"block\" : \"none\";\n    sectionControlPanel.appendChild(scpCameraScanRegion);\n    var requestPermissionContainer = document.createElement(\"div\");\n    requestPermissionContainer.style.textAlign = \"center\";\n    scpCameraScanRegion.appendChild(requestPermissionContainer);\n\n    if (this.scanTypeSelector.isCameraScanRequired()) {\n      this.createPermissionsUi(scpCameraScanRegion, requestPermissionContainer);\n    }\n\n    this.renderFileScanUi(sectionControlPanel);\n  };\n\n  Html5QrcodeScanner.prototype.renderFileScanUi = function (parent) {\n    var $this = this;\n    var fileBasedScanRegion = document.createElement(\"div\");\n    fileBasedScanRegion.id = this.getDashboardSectionFileScanRegionId();\n    fileBasedScanRegion.style.textAlign = \"center\";\n    fileBasedScanRegion.style.display = ScanTypeSelector.isCameraScanType(this.currentScanType) ? \"none\" : \"block\";\n    parent.appendChild(fileBasedScanRegion);\n    var fileScanInput = document.createElement(\"input\");\n    fileScanInput.id = this.getFileScanInputId();\n    fileScanInput.accept = \"image/*\";\n    fileScanInput.type = \"file\";\n    fileScanInput.style.width = \"200px\";\n    fileScanInput.disabled = ScanTypeSelector.isCameraScanType(this.currentScanType);\n    var fileScanLabel = document.createElement(\"span\");\n    fileScanLabel.innerText = \" Select Image\";\n    fileBasedScanRegion.appendChild(fileScanInput);\n    fileBasedScanRegion.appendChild(fileScanLabel);\n    fileScanInput.addEventListener(\"change\", function (e) {\n      if (!$this.html5Qrcode) {\n        throw \"html5Qrcode not defined\";\n      }\n\n      if (e == null || e.target == null) {\n        return;\n      }\n\n      if (!ScanTypeSelector.isFileScanType($this.currentScanType)) {\n        return;\n      }\n\n      if (e.target.files.length === 0) {\n        return;\n      }\n\n      var file = e.target.files[0];\n      $this.html5Qrcode.scanFileV2(file, true).then(function (html5qrcodeResult) {\n        $this.resetHeaderMessage();\n        $this.qrCodeSuccessCallback(html5qrcodeResult.decodedText, html5qrcodeResult);\n      }).catch(function (error) {\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n        $this.qrCodeErrorCallback(error, Html5QrcodeErrorFactory.createFrom(error));\n      });\n    });\n  };\n\n  Html5QrcodeScanner.prototype.renderCameraSelection = function (cameras) {\n    var _this = this;\n\n    var $this = this;\n    var scpCameraScanRegion = document.getElementById(this.getDashboardSectionCameraScanRegionId());\n    scpCameraScanRegion.style.textAlign = \"center\";\n    var cameraSelectionContainer = document.createElement(\"span\");\n    cameraSelectionContainer.style.marginRight = \"10px\";\n    var numCameras = cameras.length;\n    var cameraSelectionSelect = document.createElement(\"select\");\n\n    if (numCameras === 1) {\n      cameraSelectionSelect.style.display = \"none\";\n    } else {\n      var selectCameraString = Html5QrcodeScannerStrings.selectCamera();\n      cameraSelectionContainer.innerText = selectCameraString + \" (\" + cameras.length + \")  \";\n    }\n\n    cameraSelectionSelect.id = this.getCameraSelectionId();\n    var options = [];\n\n    for (var _i = 0, cameras_1 = cameras; _i < cameras_1.length; _i++) {\n      var camera = cameras_1[_i];\n      var value = camera.id;\n      var name_1 = camera.label == null ? value : camera.label;\n      var option = document.createElement(\"option\");\n      option.value = value;\n      option.innerText = name_1;\n      options.push(option);\n      cameraSelectionSelect.appendChild(option);\n    }\n\n    cameraSelectionContainer.appendChild(cameraSelectionSelect);\n    scpCameraScanRegion.appendChild(cameraSelectionContainer);\n    var cameraActionContainer = document.createElement(\"span\");\n    var cameraActionStartButton = document.createElement(\"button\");\n    cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonStartScanningText();\n    cameraActionContainer.appendChild(cameraActionStartButton);\n    var cameraActionStopButton = document.createElement(\"button\");\n    cameraActionStopButton.innerText = Html5QrcodeScannerStrings.scanButtonStopScanningText();\n    cameraActionStopButton.style.display = \"none\";\n    cameraActionStopButton.disabled = true;\n    cameraActionContainer.appendChild(cameraActionStopButton);\n    scpCameraScanRegion.appendChild(cameraActionContainer);\n\n    var resetCameraActionStartButton = function resetCameraActionStartButton(shouldShow) {\n      if (!shouldShow) {\n        cameraActionStartButton.style.display = \"none\";\n      }\n\n      cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonStartScanningText();\n      cameraActionStartButton.style.opacity = \"1\";\n      cameraActionStartButton.disabled = false;\n\n      if (shouldShow) {\n        cameraActionStartButton.style.display = \"inline-block\";\n      }\n    };\n\n    cameraActionStartButton.addEventListener(\"click\", function (_) {\n      cameraActionStartButton.innerText = Html5QrcodeScannerStrings.scanButtonScanningStarting();\n      cameraSelectionSelect.disabled = true;\n      cameraActionStartButton.disabled = true;\n      cameraActionStartButton.style.opacity = \"0.5\";\n\n      if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n        $this.showHideScanTypeSwapLink(false);\n      }\n\n      $this.resetHeaderMessage();\n      var cameraId = cameraSelectionSelect.value;\n      $this.persistedDataManager.setLastUsedCameraId(cameraId);\n      $this.html5Qrcode.start(cameraId, toHtml5QrcodeCameraScanConfig($this.config), $this.qrCodeSuccessCallback, $this.qrCodeErrorCallback).then(function (_) {\n        cameraActionStopButton.disabled = false;\n        cameraActionStopButton.style.display = \"inline-block\";\n        resetCameraActionStartButton(false);\n      }).catch(function (error) {\n        $this.showHideScanTypeSwapLink(true);\n        cameraSelectionSelect.disabled = false;\n        resetCameraActionStartButton(true);\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n      });\n    });\n\n    if (numCameras === 1) {\n      cameraActionStartButton.click();\n    }\n\n    cameraActionStopButton.addEventListener(\"click\", function (_) {\n      if (!$this.html5Qrcode) {\n        throw \"html5Qrcode not defined\";\n      }\n\n      cameraActionStopButton.disabled = true;\n      $this.html5Qrcode.stop().then(function (_) {\n        if (_this.scanTypeSelector.hasMoreThanOneScanType()) {\n          $this.showHideScanTypeSwapLink(true);\n        }\n\n        cameraSelectionSelect.disabled = false;\n        cameraActionStartButton.disabled = false;\n        cameraActionStopButton.style.display = \"none\";\n        cameraActionStartButton.style.display = \"inline-block\";\n        $this.insertCameraScanImageToScanRegion();\n      }).catch(function (error) {\n        cameraActionStopButton.disabled = false;\n        $this.setHeaderMessage(error, Html5QrcodeScannerStatus.STATUS_WARNING);\n      });\n    });\n\n    if ($this.persistedDataManager.getLastUsedCameraId()) {\n      var cameraId = $this.persistedDataManager.getLastUsedCameraId();\n      var cameraFound = false;\n\n      for (var _a = 0, options_1 = options; _a < options_1.length; _a++) {\n        var option = options_1[_a];\n\n        if (option.value === cameraId) {\n          cameraFound = true;\n          break;\n        }\n      }\n\n      if (cameraFound) {\n        cameraSelectionSelect.value = cameraId;\n        cameraActionStartButton.click();\n      } else {\n        $this.persistedDataManager.resetLastUsedCameraId();\n      }\n    }\n  };\n\n  Html5QrcodeScanner.prototype.createSectionSwap = function () {\n    var $this = this;\n    var TEXT_IF_CAMERA_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfCameraScanSelected();\n    var TEXT_IF_FILE_SCAN_SELECTED = Html5QrcodeScannerStrings.textIfFileScanSelected();\n    var section = document.getElementById(this.getDashboardSectionId());\n    var switchContainer = document.createElement(\"div\");\n    switchContainer.style.textAlign = \"center\";\n    var switchScanTypeLink = document.createElement(\"a\");\n    switchScanTypeLink.style.textDecoration = \"underline\";\n    switchScanTypeLink.id = this.getDashboardSectionSwapLinkId();\n    switchScanTypeLink.innerText = ScanTypeSelector.isCameraScanType(this.currentScanType) ? TEXT_IF_CAMERA_SCAN_SELECTED : TEXT_IF_FILE_SCAN_SELECTED;\n    switchScanTypeLink.addEventListener(\"click\", function () {\n      if (!$this.sectionSwapAllowed) {\n        if ($this.verbose) {\n          $this.logger.logError(\"Section swap called when not allowed\");\n        }\n\n        return;\n      }\n\n      $this.resetHeaderMessage();\n      $this.getFileScanInput().value = \"\";\n      $this.sectionSwapAllowed = false;\n\n      if (ScanTypeSelector.isCameraScanType($this.currentScanType)) {\n        $this.clearScanRegion();\n        $this.getFileScanInput().disabled = false;\n        $this.getCameraScanRegion().style.display = \"none\";\n        $this.getFileScanRegion().style.display = \"block\";\n        switchScanTypeLink.innerText = TEXT_IF_FILE_SCAN_SELECTED;\n        $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_FILE;\n        $this.insertFileScanImageToScanRegion();\n      } else {\n        $this.clearScanRegion();\n        $this.getFileScanInput().disabled = true;\n        $this.getCameraScanRegion().style.display = \"block\";\n        $this.getFileScanRegion().style.display = \"none\";\n        switchScanTypeLink.innerText = TEXT_IF_CAMERA_SCAN_SELECTED;\n        $this.currentScanType = Html5QrcodeScanType.SCAN_TYPE_CAMERA;\n        $this.insertCameraScanImageToScanRegion();\n        $this.startCameraScanIfPermissionExistsOnSwap();\n      }\n\n      $this.sectionSwapAllowed = true;\n    });\n    switchContainer.appendChild(switchScanTypeLink);\n    section.appendChild(switchContainer);\n  };\n\n  Html5QrcodeScanner.prototype.startCameraScanIfPermissionExistsOnSwap = function () {\n    var _this = this;\n\n    var $this = this;\n\n    if (this.persistedDataManager.hasCameraPermissions()) {\n      CameraManager.hasCameraPermissions().then(function (hasPermissions) {\n        if (hasPermissions) {\n          var permissionButton = document.getElementById($this.getCameraPermissionButtonId());\n\n          if (!permissionButton) {\n            _this.logger.logError(\"Permission button not found, fail;\");\n\n            throw \"Permission button not found\";\n          }\n\n          permissionButton.click();\n        } else {\n          $this.persistedDataManager.setHasPermission(false);\n        }\n      }).catch(function (_) {\n        $this.persistedDataManager.setHasPermission(false);\n      });\n      return;\n    }\n  };\n\n  Html5QrcodeScanner.prototype.resetHeaderMessage = function () {\n    var messageDiv = document.getElementById(this.getHeaderMessageContainerId());\n    messageDiv.style.display = \"none\";\n  };\n\n  Html5QrcodeScanner.prototype.setHeaderMessage = function (messageText, scannerStatus) {\n    if (!scannerStatus) {\n      scannerStatus = Html5QrcodeScannerStatus.STATUS_DEFAULT;\n    }\n\n    var messageDiv = this.getHeaderMessageDiv();\n    messageDiv.innerText = messageText;\n    messageDiv.style.display = \"block\";\n\n    switch (scannerStatus) {\n      case Html5QrcodeScannerStatus.STATUS_SUCCESS:\n        messageDiv.style.background = \"#6aaf5042\";\n        messageDiv.style.color = \"#477735\";\n        break;\n\n      case Html5QrcodeScannerStatus.STATUS_WARNING:\n        messageDiv.style.background = \"#cb243124\";\n        messageDiv.style.color = \"#cb2431\";\n        break;\n\n      case Html5QrcodeScannerStatus.STATUS_DEFAULT:\n      default:\n        messageDiv.style.background = \"#00000000\";\n        messageDiv.style.color = \"rgb(17, 17, 17)\";\n        break;\n    }\n  };\n\n  Html5QrcodeScanner.prototype.showHideScanTypeSwapLink = function (shouldDisplay) {\n    if (shouldDisplay !== true) {\n      shouldDisplay = false;\n    }\n\n    this.sectionSwapAllowed = shouldDisplay;\n    this.getDashboardSectionSwapLink().style.display = shouldDisplay ? \"inline-block\" : \"none\";\n  };\n\n  Html5QrcodeScanner.prototype.insertCameraScanImageToScanRegion = function () {\n    var $this = this;\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n\n    if (this.cameraScanImage) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild(this.cameraScanImage);\n      return;\n    }\n\n    this.cameraScanImage = new Image();\n\n    this.cameraScanImage.onload = function (_) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild($this.cameraScanImage);\n    };\n\n    this.cameraScanImage.width = 64;\n    this.cameraScanImage.style.opacity = \"0.8\";\n    this.cameraScanImage.src = ASSET_CAMERA_SCAN;\n  };\n\n  Html5QrcodeScanner.prototype.insertFileScanImageToScanRegion = function () {\n    var $this = this;\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n\n    if (this.fileScanImage) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild(this.fileScanImage);\n      return;\n    }\n\n    this.fileScanImage = new Image();\n\n    this.fileScanImage.onload = function (_) {\n      qrCodeScanRegion.innerHTML = \"<br>\";\n      qrCodeScanRegion.appendChild($this.fileScanImage);\n    };\n\n    this.fileScanImage.width = 64;\n    this.fileScanImage.style.opacity = \"0.8\";\n    this.fileScanImage.src = ASSET_FILE_SCAN;\n  };\n\n  Html5QrcodeScanner.prototype.clearScanRegion = function () {\n    var qrCodeScanRegion = document.getElementById(this.getScanRegionId());\n    qrCodeScanRegion.innerHTML = \"\";\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardSectionId = function () {\n    return this.elementId + \"__dashboard_section\";\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardSectionCameraScanRegionId = function () {\n    return this.elementId + \"__dashboard_section_csr\";\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardSectionFileScanRegionId = function () {\n    return this.elementId + \"__dashboard_section_fsr\";\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardSectionSwapLinkId = function () {\n    return this.elementId + \"__dashboard_section_swaplink\";\n  };\n\n  Html5QrcodeScanner.prototype.getScanRegionId = function () {\n    return this.elementId + \"__scan_region\";\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardId = function () {\n    return this.elementId + \"__dashboard\";\n  };\n\n  Html5QrcodeScanner.prototype.getFileScanInputId = function () {\n    return this.elementId + \"__filescan_input\";\n  };\n\n  Html5QrcodeScanner.prototype.getStatusSpanId = function () {\n    return this.elementId + \"__status_span\";\n  };\n\n  Html5QrcodeScanner.prototype.getHeaderMessageContainerId = function () {\n    return this.elementId + \"__header_message\";\n  };\n\n  Html5QrcodeScanner.prototype.getCameraSelectionId = function () {\n    return this.elementId + \"__camera_selection\";\n  };\n\n  Html5QrcodeScanner.prototype.getCameraPermissionButtonId = function () {\n    return this.elementId + \"__camera_permission_button\";\n  };\n\n  Html5QrcodeScanner.prototype.getCameraScanRegion = function () {\n    return document.getElementById(this.getDashboardSectionCameraScanRegionId());\n  };\n\n  Html5QrcodeScanner.prototype.getFileScanRegion = function () {\n    return document.getElementById(this.getDashboardSectionFileScanRegionId());\n  };\n\n  Html5QrcodeScanner.prototype.getFileScanInput = function () {\n    return document.getElementById(this.getFileScanInputId());\n  };\n\n  Html5QrcodeScanner.prototype.getDashboardSectionSwapLink = function () {\n    return document.getElementById(this.getDashboardSectionSwapLinkId());\n  };\n\n  Html5QrcodeScanner.prototype.getHeaderMessageDiv = function () {\n    return document.getElementById(this.getHeaderMessageContainerId());\n  };\n\n  return Html5QrcodeScanner;\n}();\n\nexport { Html5QrcodeScanner };","map":null,"metadata":{},"sourceType":"module"}