{"ast":null,"code":"import _toConsumableArray from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/var/www/prod/smartfarm/backoffice/frontend/src/components/blog/SubSoil.js\";\n\nimport moment from 'moment';\nimport React, { useState, useEffect } from 'react';\nimport { Line } from 'react-chartjs-2';\nimport { useHistory } from 'react-router-dom';\nimport { Row, Col, Card, CardHeader, CardBody, Button } from \"shards-react\";\nimport api from '../../api/api';\n\nvar SubSoil = function SubSoil(_ref) {\n  var data = _ref.data,\n      codeSensor = _ref.codeSensor;\n\n  var addDays = function addDays(date, days) {\n    var result = new Date(date);\n    result.setDate(result.getDate() + days);\n    return result;\n  };\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      historyData = _useState2[0],\n      setHistoryData = _useState2[1];\n\n  var _useState3 = useState({\n    dateStart: new Date(),\n    dateEnd: new Date()\n  }),\n      _useState4 = _slicedToArray(_useState3, 2),\n      dateValue = _useState4[0],\n      setDateValue = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentPage = _useState6[0],\n      setCurrentPage = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      totalPages = _useState8[0],\n      setTotalPages = _useState8[1];\n\n  useEffect(function () {\n    var getHistorySensor = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(page) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return api.get(\"/sensor/sensor-history/\".concat(codeSensor, \"/\").concat(addDays(dateValue.dateStart, -7), \"/\").concat(dateValue.dateEnd, \"?pageNum=1&limit=28\")).then(function (response) {\n                  var historyResult = response.data.history;\n                  var sensorCoords = response.data.sensor_id;\n                  setHistoryData(historyResult);\n                  setCurrentPage(page);\n                  setTotalPages(response.data.totalPages);\n                }).catch(function (err) {\n                  console.log(err);\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function getHistorySensor(_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    getHistorySensor();\n  }, [codeSensor]);\n  var history = useHistory();\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      state = _useState10[0],\n      setState = _useState10[1];\n\n  var getChartData = function getChartData() {\n    var labels = [];\n    var dataMv1 = [];\n    var dataMv2 = [];\n    var dataMv3 = [];\n    var array = [];\n    historyData && historyData.map(function (sensorData) {\n      var date = sensorData.time;\n      dataMv1.push(parseFloat(sensorData.mv1).toFixed(2));\n      dataMv2.push(parseFloat(sensorData.mv2).toFixed(2));\n      dataMv3.push(parseFloat(sensorData.mv3).toFixed(2));\n      labels.push(moment(date.slice(0, 10)).locale('En').format(\"MMM Do\"));\n      labels = _toConsumableArray(new Set(labels));\n      array = labels.map(function (item, idx) {\n        return labels[labels.length - 1 - idx];\n      });\n    });\n    var state = {\n      labels: array,\n      datasets: [{\n        label: 'Humidity Mv1 ',\n        lineTension: 0.5,\n        borderWidth: 2,\n        data: dataMv1,\n        fill: false,\n        backgroundColor: [\"rgba(75,192,192,0.2)\", \"rgba(75,192,192,0.4)\", \"rgba(75,192,192,0.6)\"],\n        borderColor: \"#4cd615\",\n        borderDash: [20, 5]\n      }, {\n        label: 'Humidity Mv2',\n        lineTension: 0.5,\n        borderWidth: 2,\n        data: dataMv2,\n        fill: false,\n        backgroundColor: [\"rgba(75,192,192,0.2)\", \"rgba(75,192,192,0.4)\", \"rgba(75,192,192,0.6)\"],\n        borderColor: \"rgba(75,192,192,1)\",\n        borderDash: [20, 5]\n      }, {\n        label: 'Humidity Mv3',\n        lineTension: 0.5,\n        borderWidth: 2,\n        data: dataMv3,\n        fill: false,\n        backgroundColor: [\"rgba(75,192,192,0.2)\", \"rgba(75,192,192,0.4)\", \"rgba(75,192,192,0.6)\"],\n        borderColor: \"#eca712\",\n        borderDash: [20, 5]\n      }]\n    };\n    setState(state);\n  };\n\n  useEffect(function () {\n    getChartData();\n  }, [historyData]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Line, {\n    height: 367,\n    data: state,\n    style: {\n      width: \"80%\",\n      margin: \"0 auto\"\n    },\n    options: {\n      title: {\n        display: false,\n        text: 'Subsoil Humidity (%)',\n        fontSize: 15\n      },\n      legend: {\n        display: false,\n        position: 'bottom'\n      },\n      scales: {\n        // xAxes: [{\n        //     ticks: {\n        //         autoSkip: false,\n        //         maxRotation: 90,\n        //         minRotation: 90\n        //     }\n        // }],\n        yAxes: [{\n          ticks: {\n            stepSize: 25,\n            suggestedMin: 0,\n            suggestedMax: 100,\n            callback: function callback(value, index, values) {\n              if (value === 0 || value === 25 || value === 50 || value === 75 || value === 100) {\n                return value;\n              }\n\n              return null;\n            }\n          }\n        }]\n      }\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }\n  }));\n};\n\nexport default SubSoil;","map":{"version":3,"names":["moment","React","useState","useEffect","Line","useHistory","Row","Col","Card","CardHeader","CardBody","Button","api","SubSoil","data","codeSensor","addDays","date","days","result","Date","setDate","getDate","historyData","setHistoryData","dateStart","dateEnd","dateValue","setDateValue","currentPage","setCurrentPage","totalPages","setTotalPages","getHistorySensor","page","get","then","response","historyResult","history","sensorCoords","sensor_id","catch","err","console","log","state","setState","getChartData","labels","dataMv1","dataMv2","dataMv3","array","map","sensorData","time","push","parseFloat","mv1","toFixed","mv2","mv3","slice","locale","format","Set","item","idx","length","datasets","label","lineTension","borderWidth","fill","backgroundColor","borderColor","borderDash","width","margin","title","display","text","fontSize","legend","position","scales","yAxes","ticks","stepSize","suggestedMin","suggestedMax","callback","value","index","values"],"sources":["/var/www/prod/smartfarm/backoffice/frontend/src/components/blog/SubSoil.js"],"sourcesContent":["import moment from 'moment';\nimport React , {useState,useEffect}from 'react'\nimport { Line } from  'react-chartjs-2';\nimport { useHistory } from 'react-router-dom';\nimport { Row, Col, Card, CardHeader, CardBody, Button } from \"shards-react\";\nimport api from '../../api/api';\n\n\n\nconst SubSoil = ({data,codeSensor}) => {\n\n  const addDays = (date, days) => {\n    let result = new Date(date);\n    result.setDate(result.getDate() + days);\n    return result;\n}\n\n  const [historyData,setHistoryData] = useState('')\n  const [dateValue,setDateValue] = useState({\n      dateStart : new Date(),\n      dateEnd : new Date()\n  })\n  const [currentPage, setCurrentPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(0);\n    useEffect(()=>{\n      const getHistorySensor = async (page) => {\n\n        await  api.get(`/sensor/sensor-history/${codeSensor}/${addDays(dateValue.dateStart,-7)}/${dateValue.dateEnd}?pageNum=1&limit=28`)\n        .then(response=>{\n              let historyResult = response.data.history\n              let sensorCoords = response.data.sensor_id\n              setHistoryData(historyResult)\n              setCurrentPage(page);\n              setTotalPages(response.data.totalPages);\n  \n          })\n          .catch(err=>{\n              console.log(err)\n          })\n  \n      \n     }\n     getHistorySensor()\n    },[codeSensor])\n\n\n    const history = useHistory()\n\n    const [state,setState] = useState(null)\n    const getChartData = () => {\n    \n        let labels = []   \n        let dataMv1 = []\n        let dataMv2 = []\n        let dataMv3 = []\n        let array = []\n\n        historyData && historyData.map(sensorData=>{\n                let date =sensorData.time\n                dataMv1.push(parseFloat(sensorData.mv1).toFixed(2))\n                dataMv2.push(parseFloat(sensorData.mv2).toFixed(2))\n                dataMv3.push(parseFloat(sensorData.mv3).toFixed(2))\n                labels.push(moment(date.slice(0,10)).locale('En').format(\"MMM Do\"))\n                labels = ([...new Set(labels)])\n                array = labels.map((item,idx) => labels[labels.length-1-idx])\n\n            })\n            \n\n        const state = {\n            labels: array,\n            datasets: [\n              {\n                label: 'Humidity Mv1 ',\n                lineTension: 0.5,\n                borderWidth: 2,\n                data: dataMv1,\n                fill: false,\n                backgroundColor: [\n                  \"rgba(75,192,192,0.2)\",\n                  \"rgba(75,192,192,0.4)\",\n                  \"rgba(75,192,192,0.6)\"\n                ],\n                borderColor: \"#4cd615\",\n                borderDash: [20, 5]\n              },\n              {\n                label: 'Humidity Mv2',\n                lineTension: 0.5,\n                borderWidth: 2,\n                data: dataMv2,\n                fill: false,\n                backgroundColor: [\n                  \"rgba(75,192,192,0.2)\",\n                  \"rgba(75,192,192,0.4)\",\n                  \"rgba(75,192,192,0.6)\"\n                ],\n                borderColor: \"rgba(75,192,192,1)\",\n                borderDash: [20, 5]\n              },\n              {\n                label: 'Humidity Mv3',\n                lineTension: 0.5,\n                borderWidth: 2,\n                data: dataMv3,\n                fill: false,\n                backgroundColor: [\n                  \"rgba(75,192,192,0.2)\",\n                  \"rgba(75,192,192,0.4)\",\n                  \"rgba(75,192,192,0.6)\"\n                ],\n                borderColor: \"#eca712\",\n                borderDash: [20, 5],\n              }\n            ]\n          }\n          setState(state)\n    }\n\n    useEffect(()=>{\n        getChartData()\n    },[historyData])\n\n\n  return (\n    <div>\n        <Line\n          height={367}\n\n      data={state}\n      style={{\n        width: \"80%\",\n        margin: \"0 auto\"\n      }}\n      options={{\n            title:{\n              display:false,\n              text:'Subsoil Humidity (%)',\n              fontSize:15\n            },\n            legend:{\n              display:false,\n              position:'bottom'\n            },\n             scales: {\n                // xAxes: [{\n                //     ticks: {\n                //         autoSkip: false,\n                //         maxRotation: 90,\n                //         minRotation: 90\n                //     }\n                // }],\n                yAxes: [{\n                  ticks: {\n                    stepSize: 25,\n                    suggestedMin: 0,\n                    suggestedMax: 100,\n                    callback: function(value, index, values) {\n                      if (value === 0 || value === 25 || value === 50 || value === 75 || value === 100) {\n                        return value ;\n                      }\n                      return null;\n                    }\n                  }\n                }]\n            }\n          }}\n      />\n    </div>\n  )\n}\n\nexport default SubSoil"],"mappings":"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"},"metadata":{},"sourceType":"module"}