{"ast":null,"code":"import _regeneratorRuntime from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/var/www/prod/smartfarm/backoffice/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/var/www/prod/smartfarm/backoffice/frontend/src/admin/FieldsManagement.js\";\n\nimport React, { useState, useEffect } from 'react';\nimport api from '../api/api';\nimport { Container, Row, Col, Card, CardBody, CardHeader, CardFooter, FormGroup, FormInput, ButtonGroup, Button, FormSelect } from 'shards-react';\nimport PageTitle from '../components/common/PageTitle';\nimport { useTranslation } from 'react-i18next';\nimport { Modal } from \"react-bootstrap\";\nimport swal from 'sweetalert';\nimport { useHistory } from 'react-router-dom/cjs/react-router-dom.min';\n\nvar FieldsManagement = function FieldsManagement() {\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t,\n      i18n = _useTranslation.i18n;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      fields = _useState2[0],\n      setFields = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      farms = _useState4[0],\n      setFarms = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      sensors = _useState6[0],\n      setSensors = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      users = _useState8[0],\n      setUsers = _useState8[1];\n\n  var _useState9 = useState({}),\n      _useState10 = _slicedToArray(_useState9, 2),\n      singleField = _useState10[0],\n      setSingleField = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      reports = _useState12[0],\n      setReports = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      show = _useState14[0],\n      setShow = _useState14[1];\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  };\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var getFields = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return api('/admin/fields').then(function (response) {\n                var fieldsData = response.data.fields;\n                var farmsData = response.data.farms;\n                var sensorsData = response.data.sensors;\n                var usersData = response.data.users;\n                setFields(fieldsData);\n                setFarms(farmsData);\n                setSensors(sensorsData);\n                setUsers(usersData);\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getFields() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var generateReport = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return api.get('/createBulletin').then(function (result) {\n                if (result) {\n                  swal({\n                    icon: \"success\"\n                  });\n                }\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function generateReport() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var getSingleField = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(fieldId) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return api.post('/admin/fields/single-field', {\n                fieldId: fieldId\n              }).then(function (response) {\n                if (response.data.type === \"success\") {\n                  var fieldData = response.data.field;\n                  setSingleField(fieldData);\n                  var allReports = fieldData.reports;\n                  setReports(allReports);\n                  handleShow(true);\n                }\n              }).catch(function (error) {\n                console.log(error);\n              });\n\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function getSingleField(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    getFields();\n  }, []);\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(file) {\n      var data, response, blob, url, a;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              data = {\n                filename: file\n              };\n              _context4.next = 4;\n              return api.post('/report/download', data);\n\n            case 4:\n              response = _context4.sent;\n              _context4.next = 7;\n              return response.blob();\n\n            case 7:\n              blob = _context4.sent;\n              url = URL.createObjectURL(blob);\n              a = document.createElement('a');\n              a.href = url;\n              a.download = 'historique.pdf';\n              document.body.appendChild(a);\n              a.click();\n              _context4.next = 19;\n              break;\n\n            case 16:\n              _context4.prev = 16;\n              _context4.t0 = _context4[\"catch\"](0);\n              console.error(_context4.t0);\n\n            case 19:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[0, 16]]);\n    }));\n\n    return function handleClick(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  var downloadLastReport = /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(file) {\n      var data, response, blob, url, a;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              data = {\n                filename: file\n              };\n              _context5.next = 4;\n              return api.post('/report/download', data);\n\n            case 4:\n              response = _context5.sent;\n              _context5.next = 7;\n              return response.blob();\n\n            case 7:\n              blob = _context5.sent;\n              url = URL.createObjectURL(blob);\n              a = document.createElement('a');\n              a.href = url;\n              a.download = 'historique.pdf';\n              document.body.appendChild(a);\n              a.click();\n              _context5.next = 19;\n              break;\n\n            case 16:\n              _context5.prev = 16;\n              _context5.t0 = _context5[\"catch\"](0);\n              console.error(_context5.t0);\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[0, 16]]);\n    }));\n\n    return function downloadLastReport(_x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n\n  var history = useHistory();\n\n  var goToField = function goToField(uid, userId) {\n    if (uid) {\n      localStorage.setItem(\"Field\", uid);\n    } else {\n      localStorage.setItem(\"Field\", 0);\n    }\n\n    history.push(\"/Fields/\".concat(uid));\n  };\n\n  var goToHistory = function goToHistory(code) {\n    history.push(\"/my-history/\".concat(code));\n  };\n\n  var getUserName = function getUserName(userId) {\n    var user = users.find(function (user) {\n      return user.id === userId;\n    });\n    return user ? user.name : '-';\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Container, {\n    className: \"p-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    noGutters: true,\n    className: \"page-header py-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(PageTitle, {\n    sm: \"4\",\n    title: t('list_fields'),\n    subtitle: t('list_fields'),\n    className: \"text-sm-left\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Row, {\n    className: \"d-flex justify-content-center p-4\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    lg: \"3\",\n    md: \"12\",\n    sm: \"12\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    outline: true,\n    onClick: function onClick() {\n      return generateReport();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"material-icons\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 62\n    }\n  }, \"\\uE145\"), \" Generate Reports\"))), /*#__PURE__*/React.createElement(Card, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table mb-0 text-center table-responsive-lg table-bordered\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    className: \"bg-light\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 17\n    }\n  }, t('user')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }, t('farms')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }, t('list_fields')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, t('crop_type')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, t('crop_variety')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 17\n    }\n  }, t('sensor_code')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, t('Show Field')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, t('History')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 17\n    }\n  }, t('All Reports')))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, fields && fields.map(function (field) {\n    var croptype = \"-\";\n    var variety = \"-\";\n    var farmName = \"-\";\n    var sensorCode = \"-\";\n    var userId = \"\";\n    var crops = field.crops;\n    crops.forEach(function (crop) {\n      return croptype = crop.croptypes.crop;\n    });\n    crops.forEach(function (crop) {\n      if (crop.varieties && Object.keys(crop.varieties).length !== 0) {\n        variety = crop.varieties.crop_variety;\n      }\n    });\n    farms && farms.map(function (farm) {\n      if (farm.id === field.farm_id) {\n        farmName = farm.name;\n      }\n    });\n    sensors && sensors.map(function (sensor) {\n      if (sensor.field_id === field.id) {\n        sensorCode = sensor.code;\n      }\n    });\n    var farm = farms.find(function (farm) {\n      return farm.id === field.farm_id;\n    });\n\n    if (farm) {\n      farmName = farm.name;\n      userId = farm.user_id;\n    }\n\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      key: field.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 23\n      }\n    }, getUserName(userId)), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 23\n      }\n    }, farmName), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 23\n      }\n    }, field.name), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 23\n      }\n    }, croptype), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 23\n      }\n    }, variety), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 23\n      }\n    }, sensorCode), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      outline: true,\n      onClick: function onClick() {\n        return goToField(field.uid);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 78\n      }\n    }, \"\\uE8F4\"))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      outline: true,\n      onClick: function onClick() {\n        return goToHistory(sensorCode);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 81\n      }\n    }, \"\\uE889\"))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      outline: true,\n      onClick: function onClick() {\n        return getSingleField(field.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 82\n      }\n    }, \"\\uE8F4\"))));\n  }))))), /*#__PURE__*/React.createElement(Modal, {\n    size: \"lg\",\n    show: show,\n    onHide: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Header, {\n    className: \"d-flex flex-column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Modal.Title, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 11\n    }\n  }, \" \", /*#__PURE__*/React.createElement(\"h5\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 25\n    }\n  }, \"Field :\", singleField.name))), /*#__PURE__*/React.createElement(Modal.Body, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"table\", {\n    className: \"table mb-0 text-center table-responsive-lg table-bordered\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"thead\", {\n    className: \"bg-light\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 17\n    }\n  }, t('Date')), /*#__PURE__*/React.createElement(\"th\", {\n    scope: \"col\",\n    className: \"border-0\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 17\n    }\n  }, t('Download')))), /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, reports.map(function (report) {\n    return /*#__PURE__*/React.createElement(\"tr\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 23\n      }\n    }, \" \", t('from'), \" \", report.filename.slice(37, 47), \" \", t('to'), \" \", report.filename.slice(48, 58), \" \"), /*#__PURE__*/React.createElement(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      style: {\n        background: \"none\",\n        border: \"none\",\n        outline: \"none\",\n        padding: 8,\n        margin: 5\n      },\n      onClick: function onClick() {\n        return handleClick(report.filename);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 27\n      }\n    }, \" \", /*#__PURE__*/React.createElement(\"i\", {\n      className: \"material-icons\",\n      style: {\n        fontSize: \"28px\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 168\n      }\n    }, \"\\uF000\"), \" \")));\n  })))), /*#__PURE__*/React.createElement(Modal.Footer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 11\n    }\n  }, \"Close\"))));\n};\n\nexport default FieldsManagement;","map":{"version":3,"names":["React","useState","useEffect","api","Container","Row","Col","Card","CardBody","CardHeader","CardFooter","FormGroup","FormInput","ButtonGroup","Button","FormSelect","PageTitle","useTranslation","Modal","swal","useHistory","FieldsManagement","t","i18n","fields","setFields","farms","setFarms","sensors","setSensors","users","setUsers","singleField","setSingleField","reports","setReports","show","setShow","handleClose","handleShow","getFields","then","response","fieldsData","data","farmsData","sensorsData","usersData","catch","error","console","log","generateReport","get","result","icon","getSingleField","fieldId","post","type","fieldData","field","allReports","handleClick","file","filename","blob","url","URL","createObjectURL","a","document","createElement","href","download","body","appendChild","click","downloadLastReport","history","goToField","uid","userId","localStorage","setItem","push","goToHistory","code","getUserName","user","find","id","name","map","croptype","variety","farmName","sensorCode","crops","forEach","crop","croptypes","varieties","Object","keys","length","crop_variety","farm","farm_id","sensor","field_id","user_id","report","slice","background","border","outline","padding","margin","fontSize"],"sources":["/var/www/prod/smartfarm/backoffice/frontend/src/admin/FieldsManagement.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport api from '../api/api'\nimport { Container, Row, Col, Card, CardBody, CardHeader, CardFooter, FormGroup, FormInput, ButtonGroup, Button, FormSelect } from 'shards-react'\nimport PageTitle from '../components/common/PageTitle'\nimport { useTranslation } from 'react-i18next';\nimport { Modal } from \"react-bootstrap\";\nimport swal from 'sweetalert';\nimport { useHistory } from 'react-router-dom/cjs/react-router-dom.min';\n\n\nconst FieldsManagement = () => {\n  const { t, i18n } = useTranslation();\n\n  const [fields, setFields] = useState([])\n  const [farms, setFarms] = useState([])\n  const [sensors, setSensors] = useState([])\n  const [users, setUsers] = useState([])\n  const [singleField, setSingleField] = useState({})\n  const [reports, setReports] = useState([])\n  const [show, setShow] = useState(false);\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n  const getFields = async () => {\n    await api('/admin/fields')\n      .then(response => {\n        let fieldsData = response.data.fields\n        let farmsData = response.data.farms\n        let sensorsData = response.data.sensors\n        let usersData = response.data.users\n\n        setFields(fieldsData)\n        setFarms(farmsData)\n        setSensors(sensorsData)\n        setUsers(usersData)\n      }).catch(error => {\n        console.log(error)\n      })\n  }\n\n  const generateReport = async () => {\n    await api.get('/createBulletin')\n      .then(result => {\n        if (result) {\n          swal({\n            icon: \"success\",\n          });\n\n        }\n      }).catch(error => {\n        console.log(error)\n      })\n  }\n\n  const getSingleField = async (fieldId) => {\n    await api.post('/admin/fields/single-field', { fieldId })\n      .then(response => {\n        if (response.data.type === \"success\") {\n          let fieldData = response.data.field\n          setSingleField(fieldData)\n          let allReports = fieldData.reports\n          setReports(allReports)\n          handleShow(true)\n        }\n      })\n      .catch(error => {\n        console.log(error)\n      })\n  }\n\n  useEffect(() => {\n    getFields()\n  }, [])\n\n  const handleClick = async (file) => {\n\n    try {\n      let data = { filename: file }\n      const response = await api.post('/report/download', data);\n      const blob = await response.blob();\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'historique.pdf';\n      document.body.appendChild(a);\n      a.click();\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  const downloadLastReport = async (file) => {\n\n    try {\n      let data = { filename: file }\n      const response = await api.post('/report/download', data);\n      const blob = await response.blob();\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'historique.pdf';\n      document.body.appendChild(a);\n      a.click();\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  const history = useHistory()\n  const goToField = (uid,userId) => {\n    if (uid) {\n      localStorage.setItem(\n        \"Field\",\n        uid\n      );\n    } else {\n      localStorage.setItem(\"Field\", 0);\n    }\n    history.push(`/Fields/${uid}`)\n  }\n  const goToHistory = (code) => {\n\n    history.push(`/my-history/${code}`)\n  }\n\n  const getUserName = (userId) => {\n    const user = users.find((user) => user.id === userId);\n    return user ? user.name : '-';\n  };\n  return (\n    <>\n      <Container className=\"p-4\">\n        <Row noGutters className=\"page-header py-4\">\n          <PageTitle\n            sm=\"4\"\n            title={t('list_fields')}\n            subtitle={t('list_fields')}\n            className=\"text-sm-left\"\n          />\n        </Row>\n        <Row className=\"d-flex justify-content-center p-4\">\n          <Col lg=\"3\" md=\"12\" sm=\"12\">\n            <Button outline onClick={() => generateReport()}><i className='material-icons'>&#xe145;</i> Generate Reports</Button>\n\n          </Col>\n        </Row>\n        <Card>\n          <table className=\"table mb-0 text-center table-responsive-lg table-bordered\">\n            <thead className=\"bg-light\">\n              <tr>\n                <th scope=\"col\" className=\"border-0\">{t('user')}</th>\n\n                <th scope=\"col\" className=\"border-0\">{t('farms')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('list_fields')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('crop_type')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('crop_variety')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('sensor_code')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('Show Field')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('History')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('All Reports')}</th>\n\n              </tr>\n            </thead>\n            <tbody>\n              {\n\n                fields && fields.map(field => {\n                  let croptype = \"-\"\n                  let variety = \"-\"\n                  let farmName = \"-\"\n                  let sensorCode = \"-\"\n                  let userId = \"\"\n\n                  let crops = field.crops\n                  crops.forEach(crop => (\n                    croptype = crop.croptypes.crop\n                  ))\n                  crops.forEach(crop => {\n                    if (crop.varieties && Object.keys(crop.varieties).length !== 0) {\n                      variety = crop.varieties.crop_variety\n\n                    }\n                  })\n                  farms && farms.map(farm => {\n                    if (farm.id === field.farm_id) {\n                      farmName = farm.name\n                    }\n\n                  })\n\n                  sensors && sensors.map(sensor => {\n                    if (sensor.field_id === field.id) {\n                      sensorCode = sensor.code\n                    }\n                  })\n                  const farm = farms.find((farm) => farm.id === field.farm_id);\n                  if (farm) {\n                    farmName = farm.name;\n                    userId = farm.user_id;\n                  }\n                  return (\n                    <tr key={field.id}>\n                      <td>{getUserName(userId)}</td>\n                      <td>{farmName}</td>\n                      <td>{field.name}</td>\n                      <td>{croptype}</td>\n                      <td>{variety}</td>\n                      <td>{sensorCode}</td>\n\n                      {/* <td><Button outline onClick={() => downloadLastReport()}><i className='material-icons'>&#xf090;</i></Button></td> */}\n                      <td>\n                        <Button outline onClick={() => goToField(field.uid)}><i className='material-icons'>&#xe8f4;</i></Button>\n\n                      </td>\n                      <td>\n                        <Button outline onClick={() => goToHistory(sensorCode)}><i className='material-icons'>&#xe889;</i></Button>\n\n                      </td>\n                      <td>\n\n                        <Button outline onClick={() => getSingleField(field.id)}><i className='material-icons'>&#xe8f4;</i></Button>\n\n                      </td>\n                    </tr>\n                  )\n                })\n              }\n\n            </tbody>\n          </table>\n\n        </Card>\n      </Container>\n      <Modal size=\"lg\" show={show} onHide={handleClose}>\n        <Modal.Header className=\"d-flex flex-column\" >\n          <Modal.Title> <h5>Field :{singleField.name}</h5></Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <table className=\"table mb-0 text-center table-responsive-lg table-bordered\">\n            <thead className=\"bg-light\">\n              <tr>\n                <th scope=\"col\" className=\"border-0\">{t('Date')}</th>\n                <th scope=\"col\" className=\"border-0\">{t('Download')}</th>\n\n\n              </tr>\n            </thead>\n            <tbody>\n\n              {\n\n                reports.map(report => {\n\n                  return (\n                    <tr>\n                      <td> {t('from')} {report.filename.slice(37, 47)} {t('to')} {report.filename.slice(48, 58)} </td>\n                      <td><button style={{ background: \"none\", border: \"none\", outline: \"none\", padding: 8, margin: 5 }} onClick={() => handleClick(report.filename)}> <i className='material-icons' style={{ fontSize: \"28px\" }}>&#xf000;</i> </button></td>\n                    </tr>\n                  )\n                })\n              }\n\n            </tbody>\n          </table>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button variant=\"secondary\" onClick={handleClose}>\n            Close\n          </Button>\n\n        </Modal.Footer>\n      </Modal>\n    </>\n  )\n}\n\nexport default FieldsManagement"],"mappings":"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"},"metadata":{},"sourceType":"module"}